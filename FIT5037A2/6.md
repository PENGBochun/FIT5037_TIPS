### Task 6: VPN Configuration

#### **1.1 (Recommended) Clear Old Configuration**

To ensure a clean start, clear all existing IPSec configurations on all three firewalls.

On **each router** (`CAULFIELD-FW`, `CLAYTON-FW`, `PENINSULA-FW`) run:

```bash
/ip ipsec policy remove [find]
/ip ipsec peer remove [find]
/ip ipsec identity remove [find]
/ip ipsec proposal remove [find]
```

#### **1.2 Configure Common Encryption Proposal on All Routers**

This configuration must be identical on all three routers:

```bash
/ip ipsec proposal add name=fit5037-proposal auth-algorithms=sha256 enc-algorithms=aes-256-cbc
```

#### **1.3 Configure Each Router Individually**

We will use a simple shared secret key: `MagicKey`

---

##### **On `CLAYTON-FW` (192.168.122.200)**

```bash
# --- Add Peers ---
/ip ipsec peer add address=192.168.122.201 name=peer-to-peninsula
/ip ipsec peer add address=192.168.122.202 name=peer-to-caulfield

# --- Add Identities ---
/ip ipsec identity add peer=peer-to-peninsula secret="MagicKey"
/ip ipsec identity add peer=peer-to-caulfield secret="MagicKey"

# --- Add Policies ---
/ip ipsec policy add src-address=10.200.10.0/24 dst-address=10.201.10.0/24 proposal=fit5037-proposal peer=peer-to-peninsula tunnel=yes
/ip ipsec policy add src-address=10.200.10.0/24 dst-address=10.202.10.0/24 proposal=fit5037-proposal peer=peer-to-caulfield tunnel=yes
```

---

##### **On `PENINSULA-FW` (192.168.122.201)**

```bash
# --- Add Peers ---
/ip ipsec peer add address=192.168.122.200 name=peer-to-clayton
/ip ipsec peer add address=192.168.122.202 name=peer-to-caulfield

# --- Add Identities ---
/ip ipsec identity add peer=peer-to-clayton secret="MagicKey"
/ip ipsec identity add peer=peer-to-caulfield secret="MagicKey"

# --- Add Policies ---
/ip ipsec policy add src-address=10.201.10.0/24 dst-address=10.200.10.0/24 proposal=fit5037-proposal peer=peer-to-clayton tunnel=yes
/ip ipsec policy add src-address=10.201.10.0/24 dst-address=10.202.10.0/24 proposal=fit5037-proposal peer=peer-to-caulfield tunnel=yes
```

---

##### **On `CAULFIELD-FW` (192.168.122.202)**

```bash
# --- Add Peers ---
/ip ipsec peer add address=192.168.122.200 name=peer-to-clayton
/ip ipsec peer add address=192.168.122.201 name=peer-to-peninsula

# --- Add Identities ---
/ip ipsec identity add peer=peer-to-clayton secret="MagicKey"
/ip ipsec identity add peer=peer-to-peninsula secret="MagicKey"

# --- Add Policies ---
/ip ipsec policy add src-address=10.202.10.0/24 dst-address=10.200.10.0/24 proposal=fit5037-proposal peer=peer-to-clayton tunnel=yes
/ip ipsec policy add src-address=10.202.10.0/24 dst-address=10.201.10.0/24 proposal=fit5037-proposal peer=peer-to-peninsula tunnel=yes
```
